CREATE VIEW Текущие_рейсы_на_сегодня AS
SELECT 
    Идентификатор, 
    Пункт_отправления, 
    Пункт_прибытия, 
    Дата_и_время_отправления, 
    Дата_и_время_прибытия, 
    Длина_маршрута, 
    Количество_проданных_билетов
FROM Рейсы
WHERE CURRENT_DATE = DATE(Дата_и_время_отправления)
AND CURRENT_TIMESTAMP BETWEEN Дата_и_время_отправления AND Дата_и_время_прибытия;

CREATE VIEW Расписание_на_сегодня AS
SELECT 
    r1.Идентификатор,
    r1.Пункт_отправления,
    r1.Пункт_прибытия,
    r1.Дата_и_время_отправления,
    r1.Дата_и_время_прибытия,
    (SELECT MIN(r2.Дата_и_время_отправления) 
     FROM Рейсы r2 
     WHERE r2.Водитель = r1.Водитель 
     AND r2.Дата_и_время_отправления > r1.Дата_и_время_прибытия
    ) - r1.Дата_и_время_прибытия AS Перерыв_до_следующего
FROM Рейсы r1
WHERE DATE(r1.Дата_и_время_отправления) = CURRENT_DATE;

CREATE VIEW Стоимость_поездок AS
SELECT 
    r.Идентификатор,
    r.Пункт_отправления,
    r.Пункт_прибытия,
    ts.Базовая_стоимость_за_1_км * r.Коэффициент_к_базовой_стоимости * r.Длина_маршрута AS Стоимость
FROM Рейсы r
JOIN Транспортные_средства ts ON r.Номер_ТС = ts.Гос_номерной_знак;

UPDATE Текущие_рейсы_на_сегодня
SET Количество_проданных_билетов = 10
WHERE Идентификатор = 1;

UPDATE Расписание_на_сегодня
SET Пункт_прибытия = 'Казань'
WHERE Идентификатор = 2;

INSERT INTO Стоимость_поездок (Идентификатор, Пункт_отправления, Пункт_прибытия, Стоимость) 
VALUES (10, 'Москва', 'СПБ', 5000);
