1. Проверка пересечения рейсов для каждого водителя


Вариант 1 (через JOIN)

SELECT r1.Водитель, r1.Идентификатор, r2.Идентификатор, r1.Дата_и_время_отправления, r1.Дата_и_время_прибытия, r2.Дата_и_время_отправления, r2.Дата_и_время_прибытия
FROM Рейсы r1
JOIN Рейсы r2 
    ON r1.Водитель = r2.Водитель 
   AND r1.Идентификатор <> r2.Идентификатор
   AND (
       r1.Дата_и_время_отправления BETWEEN r2.Дата_и_время_отправления AND r2.Дата_и_время_прибытия
       OR r1.Дата_и_время_прибытия BETWEEN r2.Дата_и_время_отправления AND r2.Дата_и_время_прибытия
   );

Вариант 2 (через подзапрос)

SELECT r1.Водитель, r1.Идентификатор, r2.Идентификатор
FROM Рейсы r1
WHERE EXISTS (
    SELECT 1
    FROM Рейсы r2
    WHERE r1.Водитель = r2.Водитель
    AND r1.Идентификатор <> r2.Идентификатор
    AND (
       r1.Дата_и_время_отправления BETWEEN r2.Дата_и_время_отправления AND r2.Дата_и_время_прибытия
       OR r1.Дата_и_время_прибытия BETWEEN r2.Дата_и_время_отправления AND r2.Дата_и_время_прибытия
    )
);

При JOIN база данных напрямую связывает таблицы и выполняет фильтрацию на основе индексов из-за чего выполняется быстрее.
Вариант с EXISTS менее эффективен, так как вызывает подзапрос для каждой строки.

